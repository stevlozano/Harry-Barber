<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test PWA Installation</title>
    <link rel="manifest" href="/manifest.json">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            text-align: center;
        }
        .install-btn {
            background: #000;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 18px;
            cursor: pointer;
            margin: 20px 0;
            display: none;
        }
        .status {
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            background: #f0f0f0;
        }
        .supported {
            background: #d4edda;
            color: #155724;
        }
        .unsupported {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>ðŸ§ª Test PWA Installation</h1>
    
    <div id="status" class="status">
        Checking PWA support...
    </div>
    
    <button id="installButton" class="install-btn" onclick="installApp()">
        ðŸ“² Instalar AplicaciÃ³n
    </button>
    
    <div style="margin-top: 30px;">
        <h3>Para probar la instalaciÃ³n:</h3>
        <p>1. Abre esta pÃ¡gina en Chrome/Edge</p>
        <p>2. Busca el Ã­cono de instalaciÃ³n ðŸ“¥ en la barra de direcciones</p>
        <p>3. O haz clic en el botÃ³n de arriba si aparece</p>
    </div>

    <script>
        let deferredPrompt;
        const statusEl = document.getElementById('status');
        const installBtn = document.getElementById('installButton');
        
        // Check PWA support
        if ('serviceWorker' in navigator) {
            statusEl.innerHTML = 'âœ… Service Worker soportado';
            statusEl.className = 'status supported';
        } else {
            statusEl.innerHTML = 'âŒ Service Worker no soportado';
            statusEl.className = 'status unsupported';
        }
        
        // Listen for install prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('Install prompt available');
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = 'inline-block';
            statusEl.innerHTML = 'ðŸ“² Â¡Listo para instalar! Haz clic abajo o busca el Ã­cono ðŸ“¥';
            statusEl.className = 'status supported';
        });
        
        // Listen for installation
        window.addEventListener('appinstalled', (evt) => {
            console.log('App installed');
            statusEl.innerHTML = 'ðŸŽ‰ Â¡AplicaciÃ³n instalada exitosamente!';
            statusEl.className = 'status supported';
            installBtn.style.display = 'none';
        });
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted install');
                    } else {
                        console.log('User dismissed install');
                    }
                    deferredPrompt = null;
                    installBtn.style.display = 'none';
                });
            }
        }
        
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered:', registration);
                    })
                    .catch((error) => {
                        console.log('SW registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>